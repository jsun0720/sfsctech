<?xml version="1.0" encoding="UTF-8"?>
<configuration debug="false">

    <!--格式化输出：%d：日期，%-5level：日志级别、从左显示5个字符宽度，%thread：线程名，%m：日志消息，%n：换行符-->
    <property name="default_pattern" value="%d %-5level %trace --- [%thread] %logger      : %m%n"/>
    <!-- 日志文件本地存储路径 -->
    <property name="filepath" value="/opt/logs/"/>
    <!-- kafka路径-->
    <property name="brokerList" value="172.16.225.98:9092"/>
    <property name="appName" value="cloud-feign"/>
    <property name="topic" value="website"/>

    <!-- 控制台输出 -->
    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
            <pattern>%d %clr(%-5level) %clr(%trace) --- [%20thread] %cyan(%-50logger{50}) : %m%n</pattern>
        </encoder>
    </appender>

    <!-- 只写本地文件，level>=INFO -->
    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <rollingPolicy class="com.sfsctech.common.core.logger.logback.rolling.PatchedSizeAndTimeBasedRollingPolicy">
            <FileNamePattern>${filepath}${appName}/log.%d{yyyy-MM-dd}.%i.log</FileNamePattern>
            <MaxFileSize>10MB</MaxFileSize>
            <MaxHistory>365</MaxHistory>
            <TotalSizeCap>3GB</TotalSizeCap>
        </rollingPolicy>
        <filter class="ch.qos.logback.classic.filter.ThresholdFilter">
            <!-- 小于level级别的日志会被过滤掉 -->
            <level>DEBUG</level>
        </filter>
        <encoder class="com.sfsctech.common.core.logger.logback.pattern.trace.encoder.TraceNoPatternLayoutEncoder">
            <pattern>${default_pattern}</pattern>
            <zfcode>${appName}</zfcode>
        </encoder>
    </appender>

    <logger name="com.sfsctech" level="INFO"/>
    <logger name="com.apache.ibatis" level="TRACE"/>
    <logger name="java.sql.Connection" level="DEBUG"/>
    <logger name="java.sql.Statement" level="DEBUG"/>
    <logger name="java.sql.PreparedStatement" level="DEBUG"/>

    <root level="INFO">
        <appender-ref ref="CONSOLE"/>
        <appender-ref ref="FILE"/>
    </root>

</configuration>